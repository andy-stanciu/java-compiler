    .data
BBS$$:
    .quad   0
    .quad   BBS$Init
    .quad   BBS$Print
    .quad   BBS$Sort
    .quad   BBS$Start

    .text
    .globl  asm_main
asm_main:
    pushq   %rbp
    movq    %rsp,%rbp
    movq    $24,%rdi
    call    mjcalloc
    leaq    BBS$$(%rip),%rdx
    movq    %rdx,0(%rax)
    pushq   %rax
    movq    $10,%rax
    pushq   %rax
    popq    %rsi
    popq    %rdi
    movq    0(%rdi),%rax
    call    *32(%rax)
    movq    %rax,%rdi
    call    put
    movq    %rbp,%rsp
    popq    %rbp
    ret
BBS$Start:
    pushq   %rbp
    movq    %rsp,%rbp
    subq    $32,%rsp
    movq    %rdi,-8(%rbp)
    movq    %rsi,-16(%rbp)
    leaq    -24(%rbp),%rax
    pushq   %rax
    movq    -8(%rbp),%rax
    pushq   %rax
    movq    -16(%rbp),%rax
    pushq   %rax
    popq    %rsi
    popq    %rdi
    movq    0(%rdi),%rax
    pushq   %rcx
    call    *8(%rax)
    popq    %rcx
    popq    %rdx
    movq    %rax,0(%rdx)
    leaq    -24(%rbp),%rax
    pushq   %rax
    movq    -8(%rbp),%rax
    pushq   %rax
    popq    %rdi
    movq    0(%rdi),%rax
    pushq   %rcx
    call    *16(%rax)
    popq    %rcx
    popq    %rdx
    movq    %rax,0(%rdx)
    movq    $99999,%rax
    movq    %rax,%rdi
    call    put
    leaq    -24(%rbp),%rax
    pushq   %rax
    movq    -8(%rbp),%rax
    pushq   %rax
    popq    %rdi
    movq    0(%rdi),%rax
    pushq   %rcx
    call    *24(%rax)
    popq    %rcx
    popq    %rdx
    movq    %rax,0(%rdx)
    leaq    -24(%rbp),%rax
    pushq   %rax
    movq    -8(%rbp),%rax
    pushq   %rax
    popq    %rdi
    movq    0(%rdi),%rax
    pushq   %rcx
    call    *16(%rax)
    popq    %rcx
    popq    %rdx
    movq    %rax,0(%rdx)
    movq    $0,%rax
    movq    %rbp,%rsp
    popq    %rbp
    ret
BBS$Sort:
    pushq   %rbp
    movq    %rsp,%rbp
    subq    $80,%rsp
    movq    %rdi,-8(%rbp)
    leaq    -24(%rbp),%rax
    pushq   %rax
    movq    -8(%rbp),%rdx
    movq    16(%rdx),%rax
    pushq   %rax
    movq    $1,%rax
    popq    %rdx
    movq    %rax,%rcx
    subq    %rcx,%rdx
    movq    %rdx,%rax
    popq    %rdx
    movq    %rax,0(%rdx)
    leaq    -32(%rbp),%rax
    pushq   %rax
    movq    $0,%rax
    pushq   %rax
    movq    $1,%rax
    popq    %rdx
    movq    %rax,%rcx
    subq    %rcx,%rdx
    movq    %rdx,%rax
    popq    %rdx
    movq    %rax,0(%rdx)
    jmp     while_test0
while0:
    leaq    -72(%rbp),%rax
    pushq   %rax
    movq    $1,%rax
    popq    %rdx
    movq    %rax,0(%rdx)
    jmp     while_test1
while1:
    leaq    -64(%rbp),%rax
    pushq   %rax
    movq    -72(%rbp),%rax
    pushq   %rax
    movq    $1,%rax
    popq    %rdx
    movq    %rax,%rcx
    subq    %rcx,%rdx
    movq    %rdx,%rax
    popq    %rdx
    movq    %rax,0(%rdx)
    leaq    -40(%rbp),%rax
    pushq   %rax
    movq    -8(%rbp),%rdx
    movq    8(%rdx),%rax
    pushq   %rax
    movq    -64(%rbp),%rax
    popq    %rdx
    movq    %rax,%rdi
    movq    0(%rdx),%rsi
    cmpq    $0,%rdi
    jl      exception_array
    cmpq    %rsi,%rdi
    jge     exception_array
    addq    $1,%rdi
    movq    (%rdx,%rdi,8),%rax
    popq    %rdx
    movq    %rax,0(%rdx)
    leaq    -48(%rbp),%rax
    pushq   %rax
    movq    -8(%rbp),%rdx
    movq    8(%rdx),%rax
    pushq   %rax
    movq    -72(%rbp),%rax
    popq    %rdx
    movq    %rax,%rdi
    movq    0(%rdx),%rsi
    cmpq    $0,%rdi
    jl      exception_array
    cmpq    %rsi,%rdi
    jge     exception_array
    addq    $1,%rdi
    movq    (%rdx,%rdi,8),%rax
    popq    %rdx
    movq    %rax,0(%rdx)
    movq    -48(%rbp),%rax
    pushq   %rax
    movq    -40(%rbp),%rax
    popq    %rdx
    cmpq    %rax,%rdx
    jl      true0
    movq    $0,%rax
    jmp     else0
true0:
    movq    $1,%rax
join0:
    leaq    -56(%rbp),%rax
    pushq   %rax
    movq    -72(%rbp),%rax
    pushq   %rax
    movq    $1,%rax
    popq    %rdx
    movq    %rax,%rcx
    subq    %rcx,%rdx
    movq    %rdx,%rax
    popq    %rdx
    movq    %rax,0(%rdx)
    leaq    -80(%rbp),%rax
    pushq   %rax
    movq    -8(%rbp),%rdx
    movq    8(%rdx),%rax
    pushq   %rax
    movq    -56(%rbp),%rax
    popq    %rdx
    movq    %rax,%rdi
    movq    0(%rdx),%rsi
    cmpq    $0,%rdi
    jl      exception_array
    cmpq    %rsi,%rdi
    jge     exception_array
    addq    $1,%rdi
    movq    (%rdx,%rdi,8),%rax
    popq    %rdx
    movq    %rax,0(%rdx)
    movq    -8(%rbp),%rdx
    leaq    8(%rdx),%rax
    pushq   0(%rax)
    movq    -56(%rbp),%rax
    popq    %rdx
    movq    %rax,%rdi
    movq    0(%rdx),%rsi
    cmpq    $0,%rdi
    jl      exception_array
    cmpq    %rsi,%rdi
    jge     exception_array
    addq    $1,%rdi
    pushq   %rdx
    pushq   %rdi
    movq    -8(%rbp),%rdx
    movq    8(%rdx),%rax
    pushq   %rax
    movq    -72(%rbp),%rax
    popq    %rdx
    movq    %rax,%rdi
    movq    0(%rdx),%rsi
    cmpq    $0,%rdi
    jl      exception_array
    cmpq    %rsi,%rdi
    jge     exception_array
    addq    $1,%rdi
    movq    (%rdx,%rdi,8),%rax
    popq    %rdi
    popq    %rdx
    movq    %rax,(%rdx,%rdi,8)
    movq    -8(%rbp),%rdx
    leaq    8(%rdx),%rax
    pushq   0(%rax)
    movq    -72(%rbp),%rax
    popq    %rdx
    movq    %rax,%rdi
    movq    0(%rdx),%rsi
    cmpq    $0,%rdi
    jl      exception_array
    cmpq    %rsi,%rdi
    jge     exception_array
    addq    $1,%rdi
    pushq   %rdx
    pushq   %rdi
    movq    -80(%rbp),%rax
    popq    %rdi
    popq    %rdx
    movq    %rax,(%rdx,%rdi,8)
    jmp     end_if0
else0:
    leaq    -16(%rbp),%rax
    pushq   %rax
    movq    $0,%rax
    popq    %rdx
    movq    %rax,0(%rdx)
end_if0:
    leaq    -72(%rbp),%rax
    pushq   %rax
    movq    -72(%rbp),%rax
    pushq   %rax
    movq    $1,%rax
    popq    %rdx
    addq    %rdx,%rax
    popq    %rdx
    movq    %rax,0(%rdx)
while_test1:
    movq    -72(%rbp),%rax
    pushq   %rax
    movq    -24(%rbp),%rax
    pushq   %rax
    movq    $1,%rax
    popq    %rdx
    addq    %rdx,%rax
    popq    %rdx
    cmpq    %rax,%rdx
    jl      true1
    movq    $0,%rax
    jmp     join1
true1:
    movq    $1,%rax
    jmp     while1
join1:
    leaq    -24(%rbp),%rax
    pushq   %rax
    movq    -24(%rbp),%rax
    pushq   %rax
    movq    $1,%rax
    popq    %rdx
    movq    %rax,%rcx
    subq    %rcx,%rdx
    movq    %rdx,%rax
    popq    %rdx
    movq    %rax,0(%rdx)
while_test0:
    movq    -32(%rbp),%rax
    pushq   %rax
    movq    -24(%rbp),%rax
    popq    %rdx
    cmpq    %rax,%rdx
    jl      true2
    movq    $0,%rax
    jmp     join2
true2:
    movq    $1,%rax
    jmp     while0
join2:
    movq    $0,%rax
    movq    %rbp,%rsp
    popq    %rbp
    ret
BBS$Print:
    pushq   %rbp
    movq    %rsp,%rbp
    subq    $16,%rsp
    movq    %rdi,-8(%rbp)
    leaq    -16(%rbp),%rax
    pushq   %rax
    movq    $0,%rax
    popq    %rdx
    movq    %rax,0(%rdx)
    jmp     while_test2
while2:
    movq    -8(%rbp),%rdx
    movq    8(%rdx),%rax
    pushq   %rax
    movq    -16(%rbp),%rax
    popq    %rdx
    movq    %rax,%rdi
    movq    0(%rdx),%rsi
    cmpq    $0,%rdi
    jl      exception_array
    cmpq    %rsi,%rdi
    jge     exception_array
    addq    $1,%rdi
    movq    (%rdx,%rdi,8),%rax
    movq    %rax,%rdi
    call    put
    leaq    -16(%rbp),%rax
    pushq   %rax
    movq    -16(%rbp),%rax
    pushq   %rax
    movq    $1,%rax
    popq    %rdx
    addq    %rdx,%rax
    popq    %rdx
    movq    %rax,0(%rdx)
while_test2:
    movq    -16(%rbp),%rax
    pushq   %rax
    movq    -8(%rbp),%rdx
    movq    16(%rdx),%rax
    popq    %rdx
    cmpq    %rax,%rdx
    jl      true3
    movq    $0,%rax
    jmp     join3
true3:
    movq    $1,%rax
    jmp     while2
join3:
    movq    $0,%rax
    movq    %rbp,%rsp
    popq    %rbp
    ret
BBS$Init:
    pushq   %rbp
    movq    %rsp,%rbp
    subq    $16,%rsp
    movq    %rdi,-8(%rbp)
    movq    %rsi,-16(%rbp)
    movq    -8(%rbp),%rdx
    leaq    16(%rdx),%rax
    pushq   %rax
    movq    -16(%rbp),%rax
    popq    %rdx
    movq    %rax,0(%rdx)
    movq    -8(%rbp),%rdx
    leaq    8(%rdx),%rax
    pushq   %rax
    movq    -16(%rbp),%rax
    pushq   %rax
    addq    $1,%rax
    shlq    $3,%rax
    movq    %rax,%rdi
    call    mjcalloc
    popq    %rdx
    movq    %rdx,0(%rax)
    popq    %rdx
    movq    %rax,0(%rdx)
    movq    -8(%rbp),%rdx
    leaq    8(%rdx),%rax
    pushq   0(%rax)
    movq    $0,%rax
    popq    %rdx
    movq    %rax,%rdi
    movq    0(%rdx),%rsi
    cmpq    $0,%rdi
    jl      exception_array
    cmpq    %rsi,%rdi
    jge     exception_array
    addq    $1,%rdi
    pushq   %rdx
    pushq   %rdi
    movq    $20,%rax
    popq    %rdi
    popq    %rdx
    movq    %rax,(%rdx,%rdi,8)
    movq    -8(%rbp),%rdx
    leaq    8(%rdx),%rax
    pushq   0(%rax)
    movq    $1,%rax
    popq    %rdx
    movq    %rax,%rdi
    movq    0(%rdx),%rsi
    cmpq    $0,%rdi
    jl      exception_array
    cmpq    %rsi,%rdi
    jge     exception_array
    addq    $1,%rdi
    pushq   %rdx
    pushq   %rdi
    movq    $7,%rax
    popq    %rdi
    popq    %rdx
    movq    %rax,(%rdx,%rdi,8)
    movq    -8(%rbp),%rdx
    leaq    8(%rdx),%rax
    pushq   0(%rax)
    movq    $2,%rax
    popq    %rdx
    movq    %rax,%rdi
    movq    0(%rdx),%rsi
    cmpq    $0,%rdi
    jl      exception_array
    cmpq    %rsi,%rdi
    jge     exception_array
    addq    $1,%rdi
    pushq   %rdx
    pushq   %rdi
    movq    $12,%rax
    popq    %rdi
    popq    %rdx
    movq    %rax,(%rdx,%rdi,8)
    movq    -8(%rbp),%rdx
    leaq    8(%rdx),%rax
    pushq   0(%rax)
    movq    $3,%rax
    popq    %rdx
    movq    %rax,%rdi
    movq    0(%rdx),%rsi
    cmpq    $0,%rdi
    jl      exception_array
    cmpq    %rsi,%rdi
    jge     exception_array
    addq    $1,%rdi
    pushq   %rdx
    pushq   %rdi
    movq    $18,%rax
    popq    %rdi
    popq    %rdx
    movq    %rax,(%rdx,%rdi,8)
    movq    -8(%rbp),%rdx
    leaq    8(%rdx),%rax
    pushq   0(%rax)
    movq    $4,%rax
    popq    %rdx
    movq    %rax,%rdi
    movq    0(%rdx),%rsi
    cmpq    $0,%rdi
    jl      exception_array
    cmpq    %rsi,%rdi
    jge     exception_array
    addq    $1,%rdi
    pushq   %rdx
    pushq   %rdi
    movq    $2,%rax
    popq    %rdi
    popq    %rdx
    movq    %rax,(%rdx,%rdi,8)
    movq    -8(%rbp),%rdx
    leaq    8(%rdx),%rax
    pushq   0(%rax)
    movq    $5,%rax
    popq    %rdx
    movq    %rax,%rdi
    movq    0(%rdx),%rsi
    cmpq    $0,%rdi
    jl      exception_array
    cmpq    %rsi,%rdi
    jge     exception_array
    addq    $1,%rdi
    pushq   %rdx
    pushq   %rdi
    movq    $11,%rax
    popq    %rdi
    popq    %rdx
    movq    %rax,(%rdx,%rdi,8)
    movq    -8(%rbp),%rdx
    leaq    8(%rdx),%rax
    pushq   0(%rax)
    movq    $6,%rax
    popq    %rdx
    movq    %rax,%rdi
    movq    0(%rdx),%rsi
    cmpq    $0,%rdi
    jl      exception_array
    cmpq    %rsi,%rdi
    jge     exception_array
    addq    $1,%rdi
    pushq   %rdx
    pushq   %rdi
    movq    $6,%rax
    popq    %rdi
    popq    %rdx
    movq    %rax,(%rdx,%rdi,8)
    movq    -8(%rbp),%rdx
    leaq    8(%rdx),%rax
    pushq   0(%rax)
    movq    $7,%rax
    popq    %rdx
    movq    %rax,%rdi
    movq    0(%rdx),%rsi
    cmpq    $0,%rdi
    jl      exception_array
    cmpq    %rsi,%rdi
    jge     exception_array
    addq    $1,%rdi
    pushq   %rdx
    pushq   %rdi
    movq    $9,%rax
    popq    %rdi
    popq    %rdx
    movq    %rax,(%rdx,%rdi,8)
    movq    -8(%rbp),%rdx
    leaq    8(%rdx),%rax
    pushq   0(%rax)
    movq    $8,%rax
    popq    %rdx
    movq    %rax,%rdi
    movq    0(%rdx),%rsi
    cmpq    $0,%rdi
    jl      exception_array
    cmpq    %rsi,%rdi
    jge     exception_array
    addq    $1,%rdi
    pushq   %rdx
    pushq   %rdi
    movq    $19,%rax
    popq    %rdi
    popq    %rdx
    movq    %rax,(%rdx,%rdi,8)
    movq    -8(%rbp),%rdx
    leaq    8(%rdx),%rax
    pushq   0(%rax)
    movq    $9,%rax
    popq    %rdx
    movq    %rax,%rdi
    movq    0(%rdx),%rsi
    cmpq    $0,%rdi
    jl      exception_array
    cmpq    %rsi,%rdi
    jge     exception_array
    addq    $1,%rdi
    pushq   %rdx
    pushq   %rdi
    movq    $5,%rax
    popq    %rdi
    popq    %rdx
    movq    %rax,(%rdx,%rdi,8)
    movq    $0,%rax
    movq    %rbp,%rsp
    popq    %rbp
    ret
